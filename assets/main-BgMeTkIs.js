(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const t of l)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(l){const t={};return l.integrity&&(t.integrity=l.integrity),l.referrerPolicy&&(t.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?t.credentials="include":l.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(l){if(l.ep)return;l.ep=!0;const t=n(l);fetch(l.href,t)}})();const Pt=[{country:"United States",code:"USA",obesity:36.2,activity:5800,upf:58.7,inactivity:43,lat:37.09,lon:-95.71},{country:"China",code:"CHN",obesity:6.2,activity:4200,upf:22.3,inactivity:14,lat:35.86,lon:104.19},{country:"India",code:"IND",obesity:3.9,activity:4500,upf:18.5,inactivity:34,lat:20.59,lon:78.96},{country:"United Kingdom",code:"GBR",obesity:27.8,activity:5200,upf:50.7,inactivity:36,lat:55.37,lon:-3.43},{country:"Germany",code:"DEU",obesity:22.3,activity:5400,upf:46.2,inactivity:42,lat:51.16,lon:10.45},{country:"France",code:"FRA",obesity:21.6,activity:5300,upf:35.9,inactivity:29,lat:46.22,lon:2.21},{country:"Japan",code:"JPN",obesity:4.3,activity:6800,upf:25.1,inactivity:36,lat:36.2,lon:138.25},{country:"Australia",code:"AUS",obesity:29,activity:5900,upf:42,inactivity:44,lat:-25.27,lon:133.77},{country:"Canada",code:"CAN",obesity:29.4,activity:5700,upf:48.3,inactivity:46,lat:56.13,lon:-106.34},{country:"Mexico",code:"MEX",obesity:28.9,activity:4100,upf:30,inactivity:26,lat:23.63,lon:-102.55},{country:"Brazil",code:"BRA",obesity:22.1,activity:3800,upf:27.4,inactivity:47,lat:-14.23,lon:-51.92},{country:"Italy",code:"ITA",obesity:19.9,activity:5100,upf:33.5,inactivity:41,lat:41.87,lon:12.56},{country:"Spain",code:"ESP",obesity:23.8,activity:5e3,upf:31.7,inactivity:36,lat:40.46,lon:-3.74},{country:"Netherlands",code:"NLD",obesity:20.4,activity:5600,upf:38.9,inactivity:26,lat:52.13,lon:5.29},{country:"Sweden",code:"SWE",obesity:20.6,activity:5500,upf:34.2,inactivity:32,lat:60.12,lon:18.64},{country:"South Korea",code:"KOR",obesity:4.7,activity:5300,upf:24.8,inactivity:38,lat:35.9,lon:127.76},{country:"Turkey",code:"TUR",obesity:32.1,activity:3900,upf:26.5,inactivity:49,lat:38.96,lon:35.24},{country:"Saudi Arabia",code:"SAU",obesity:35.4,activity:3200,upf:44.2,inactivity:53,lat:23.88,lon:45.07},{country:"United Arab Emirates",code:"ARE",obesity:31.7,activity:3500,upf:52.1,inactivity:38,lat:23.42,lon:53.84},{country:"Indonesia",code:"IDN",obesity:6.9,activity:3600,upf:16.2,inactivity:27,lat:-.78,lon:113.92},{country:"Philippines",code:"PHL",obesity:6.4,activity:3400,upf:19.8,inactivity:31,lat:12.87,lon:121.77},{country:"Ireland",code:"IRL",obesity:25.3,activity:5800,upf:45.9,inactivity:32,lat:53.41,lon:-8.24},{country:"Poland",code:"POL",obesity:23.1,activity:4800,upf:34.6,inactivity:40,lat:51.91,lon:19.14},{country:"Taiwan",code:"TWN",obesity:8,activity:4900,upf:22.7,inactivity:22,lat:23.69,lon:120.96}],gt={1975:{multiplier:.33},1980:{multiplier:.37},1985:{multiplier:.42},1990:{multiplier:.49},1995:{multiplier:.57},2e3:{multiplier:.66},2005:{multiplier:.75},2010:{multiplier:.85},2015:{multiplier:.93},2020:{multiplier:1},2022:{multiplier:1}};function Tt(e,a,n="adults"){var s;const o=((s=Pt.find(_=>_.country===e))==null?void 0:s.obesity)||0,l=gt[a];if(!l)return o;let t=o*l.multiplier;return n==="children"&&(t=t*.55),t}const vt=[1975,1980,1985,1990,1995,2e3,2005,2010,2015,2020,2022],lt=[{Population:"United Arab Emirates",ISO:"ARE",HDI_score:"0.911",HDI_rank:25,Economy:"highHDI",N_M:10,BodyMass_M:79.65,Height_M:"173.9",BMI_M:"26.34",Fat_M:29.94,TEE_M:9.06,BEEmeas_M:null,BEEest_M:"6.96",AEE_M:1.2,PAL_M:1.31,adj_BMI_TEE_slope_M:"4.311",adj_Fat_TEE_slope_M:"-1.359",N_F:"10",BodyMass_F:"61.74",Height_F:"160.1",BMI_F:"23.98",Fat_F:"35.9",TEE_F:"6.82",BEEmeas_F:null,BEEest_F:"5.4",AEE_F:"0.74",PAL_F:"1.25",adj_BMI_TEE_slope_F:"10.831",adj_Fat_TEE_slope_F:"7.337",PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:25.2048,lon:55.2708},{Population:"Australia",ISO:"AUS",HDI_score:"0.951",HDI_rank:5,Economy:"highHDI",N_M:6,BodyMass_M:81.43,Height_M:"182.5",BMI_M:"24.44",Fat_M:15.34,TEE_M:19.32,BEEmeas_M:null,BEEest_M:"7.98",AEE_M:9.41,PAL_M:2.43,adj_BMI_TEE_slope_M:"27.093",adj_Fat_TEE_slope_M:"4.986",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:"38.9",UPF_source:"1",kg_meat:"118.23",meat_source:"2",lat:-25.2744,lon:133.7751},{Population:"Aymara",ISO:"AYM",HDI_score:null,HDI_rank:205,Economy:"AGP",N_M:9,BodyMass_M:56.5,Height_M:"162.96",BMI_M:"21.3",Fat_M:18.39,TEE_M:12.24,BEEmeas_M:null,BEEest_M:"6.17",AEE_M:4.85,PAL_M:1.98,adj_BMI_TEE_slope_M:"6.141",adj_Fat_TEE_slope_M:"0.792",N_F:"10",BodyMass_F:"53.53",Height_F:"153.61",BMI_F:"22.68",Fat_F:"32.67",TEE_F:"9.97",BEEmeas_F:null,BEEest_F:"5.08",AEE_F:"3.9",PAL_F:"1.99",adj_BMI_TEE_slope_F:"-14.503",adj_Fat_TEE_slope_F:"-18.373",PercUPF:"2.5",UPF_source:"3",kg_meat:null,meat_source:null,lat:-16.2,lon:-68.55},{Population:"Belgium",ISO:"BEL",HDI_score:"0.937",HDI_rank:16,Economy:"highHDI",N_M:19,BodyMass_M:78.01,Height_M:"178.0",BMI_M:"24.67",Fat_M:25.19,TEE_M:13.75,BEEmeas_M:"6.9",BEEest_M:null,AEE_M:5.47,PAL_M:1.99,adj_BMI_TEE_slope_M:"10.332",adj_Fat_TEE_slope_M:"4.298",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:"30.3",UPF_source:"1",kg_meat:"69.64",meat_source:"2",lat:50.8503,lon:4.3517},{Population:"Bolivia",ISO:"BOL",HDI_score:"0.692",HDI_rank:119,Economy:"midHDI",N_M:4,BodyMass_M:65.88,Height_M:"181.75",BMI_M:"19.95",Fat_M:5.04,TEE_M:13.15,BEEmeas_M:"6.84",BEEest_M:null,AEE_M:4.99,PAL_M:1.93,adj_BMI_TEE_slope_M:"-68.026",adj_Fat_TEE_slope_M:"-2.703",N_F:"2",BodyMass_F:"51.0",Height_F:"160.0",BMI_F:"19.91",Fat_F:"20.08",TEE_F:"9.0",BEEmeas_F:"5.45",BEEest_F:null,AEE_F:"2.65",PAL_F:"1.66",adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:"62.659",PercUPF:"9.5",UPF_source:"4",kg_meat:"67.17",meat_source:"2",lat:-16.2902,lon:-63.5887},{Population:"Switzerland",ISO:"CHE",HDI_score:"0.962",HDI_rank:3,Economy:"highHDI",N_M:1,BodyMass_M:75.6,Height_M:"176.0",BMI_M:"24.41",Fat_M:25.33,TEE_M:16.72,BEEmeas_M:"7.4",BEEest_M:null,AEE_M:7.65,PAL_M:2.26,adj_BMI_TEE_slope_M:null,adj_Fat_TEE_slope_M:null,N_F:"1",BodyMass_F:"53.6",Height_F:"157.0",BMI_F:"21.75",Fat_F:"26.3",TEE_F:"11.94",BEEmeas_F:"6.1",BEEest_F:null,AEE_F:"4.64",PAL_F:"1.96",adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:"28.7",UPF_source:"5",kg_meat:"73.03",meat_source:"2",lat:46.8182,lon:8.2275},{Population:"Chile",ISO:"CHL",HDI_score:"0.855",HDI_rank:43,Economy:"highHDI",N_M:6,BodyMass_M:55.02,Height_M:"167.5",BMI_M:"19.61",Fat_M:9.64,TEE_M:11.36,BEEmeas_M:null,BEEest_M:"6.2",AEE_M:4.02,PAL_M:1.83,adj_BMI_TEE_slope_M:"21.338",adj_Fat_TEE_slope_M:"-0.651",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:"28.6",UPF_source:"1",kg_meat:"82.34",meat_source:"2",lat:-35.6751,lon:-71.543},{Population:"China",ISO:"CHN",HDI_score:"0.768",HDI_rank:82,Economy:"midHDI",N_M:null,BodyMass_M:null,Height_M:null,BMI_M:null,Fat_M:null,TEE_M:null,BEEmeas_M:null,BEEest_M:null,AEE_M:null,PAL_M:null,adj_BMI_TEE_slope_M:null,adj_Fat_TEE_slope_M:null,N_F:"42",BodyMass_F:"51.04",Height_F:"162.37",BMI_F:"19.35",Fat_F:"28.04",TEE_F:"7.38",BEEmeas_F:null,BEEest_F:"5.7",AEE_F:"0.94",PAL_F:"1.31",adj_BMI_TEE_slope_F:"-11.229",adj_Fat_TEE_slope_F:"-4.659",PercUPF:"3.6",UPF_source:"6",kg_meat:"59.17",meat_source:"2",lat:35.8617,lon:104.1954},{Population:"Germany",ISO:"DEU",HDI_score:"0.941",HDI_rank:7,Economy:"highHDI",N_M:34,BodyMass_M:89.54,Height_M:"180.59",BMI_M:"27.46",Fat_M:27.39,TEE_M:14.01,BEEmeas_M:null,BEEest_M:"7.69",AEE_M:4.92,PAL_M:1.83,adj_BMI_TEE_slope_M:"-5.457",adj_Fat_TEE_slope_M:"-0.212",N_F:"41",BodyMass_F:"75.47",Height_F:"168.27",BMI_F:"26.7",Fat_F:"37.05",TEE_F:"10.86",BEEmeas_F:null,BEEest_F:"6.21",AEE_F:"3.57",PAL_F:"1.75",adj_BMI_TEE_slope_F:"-5.852",adj_Fat_TEE_slope_F:"-2.019",PercUPF:"38.45",UPF_source:"7",kg_meat:"86.76",meat_source:"2",lat:51.1657,lon:10.4515},{Population:"Daasanach",ISO:"DSN",HDI_score:null,HDI_rank:204,Economy:"AGP",N_M:15,BodyMass_M:52.47,Height_M:"170.93",BMI_M:"17.97",Fat_M:14.22,TEE_M:10.58,BEEmeas_M:null,BEEest_M:"5.82",AEE_M:3.7,PAL_M:1.8,adj_BMI_TEE_slope_M:"-6.924",adj_Fat_TEE_slope_M:"4.62",N_F:"19",BodyMass_F:"49.26",Height_F:"163.75",BMI_F:"18.52",Fat_F:"24.95",TEE_F:"9.14",BEEmeas_F:null,BEEest_F:"5.12",AEE_F:"3.1",PAL_F:"1.77",adj_BMI_TEE_slope_F:"-27.248",adj_Fat_TEE_slope_F:"2.418",PercUPF:"2.5",UPF_source:"Obs.",kg_meat:null,meat_source:null,lat:4.6,lon:36.2},{Population:"Finland",ISO:"FIN",HDI_score:"0.94",HDI_rank:12,Economy:"highHDI",N_M:36,BodyMass_M:80.75,Height_M:"177.86",BMI_M:"25.47",Fat_M:25.73,TEE_M:14.63,BEEmeas_M:"7.68",BEEest_M:null,AEE_M:5.49,PAL_M:1.91,adj_BMI_TEE_slope_M:"-3.092",adj_Fat_TEE_slope_M:"-11.501",N_F:"30",BodyMass_F:"76.41",Height_F:"164.27",BMI_F:"28.31",Fat_F:"36.48",TEE_F:"10.3",BEEmeas_F:"6.01",BEEest_F:null,AEE_F:"3.25",PAL_F:"1.72",adj_BMI_TEE_slope_F:"7.637",adj_Fat_TEE_slope_F:"1.943",PercUPF:"31.75",UPF_source:"7",kg_meat:"76.77",meat_source:"2",lat:64,lon:26},{Population:"France",ISO:"FRA",HDI_score:"0.903",HDI_rank:28,Economy:"highHDI",N_M:6,BodyMass_M:73.83,Height_M:"179.83",BMI_M:"22.82",Fat_M:16.85,TEE_M:13.04,BEEmeas_M:null,BEEest_M:"7.34",AEE_M:4.39,PAL_M:1.77,adj_BMI_TEE_slope_M:"-31.967",adj_Fat_TEE_slope_M:"-15.183",N_F:"33",BodyMass_F:"75.02",Height_F:null,BMI_F:null,Fat_F:"34.19",TEE_F:"11.12",BEEmeas_F:null,BEEest_F:"5.84",AEE_F:"4.16",PAL_F:"1.94",adj_BMI_TEE_slope_F:"-2.37",adj_Fat_TEE_slope_F:"12.616",PercUPF:"20.27",UPF_source:"1",kg_meat:"88.51",meat_source:"2",lat:46.2276,lon:2.2137},{Population:"United Kingdom",ISO:"GBR",HDI_score:"0.929",HDI_rank:17,Economy:"highHDI",N_M:25,BodyMass_M:78.87,Height_M:"177.01",BMI_M:"25.1",Fat_M:22.45,TEE_M:13.4,BEEmeas_M:"6.56",BEEest_M:null,AEE_M:5.5,PAL_M:2.08,adj_BMI_TEE_slope_M:"-16.485",adj_Fat_TEE_slope_M:"-4.111",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:"50.05",UPF_source:"1",kg_meat:"82.28",meat_source:"2",lat:55.3781,lon:-3.436},{Population:"Ghana",ISO:"GHA",HDI_score:"0.632",HDI_rank:135,Economy:"lowHDI",N_M:31,BodyMass_M:62.76,Height_M:"168.8",BMI_M:"22.03",Fat_M:14.46,TEE_M:12.18,BEEmeas_M:"6.77",BEEest_M:null,AEE_M:4.19,PAL_M:1.8,adj_BMI_TEE_slope_M:"-6.906",adj_Fat_TEE_slope_M:"-5.964",N_F:"38",BodyMass_F:"63.22",Height_F:"157.57",BMI_F:"25.6",Fat_F:"32.94",TEE_F:"9.92",BEEmeas_F:"5.81",BEEest_F:null,AEE_F:"3.12",PAL_F:"1.7",adj_BMI_TEE_slope_F:"-9.671",adj_Fat_TEE_slope_F:"-0.746",PercUPF:null,UPF_source:null,kg_meat:"17.06",meat_source:"2",lat:7.9465,lon:-1.0232},{Population:"Gambia",ISO:"GMB",HDI_score:"0.5",HDI_rank:173,Economy:"lowHDI",N_M:8,BodyMass_M:61.16,Height_M:"169.63",BMI_M:"21.18",Fat_M:12.65,TEE_M:16.23,BEEmeas_M:"6.71",BEEest_M:null,AEE_M:7.9,PAL_M:2.4,adj_BMI_TEE_slope_M:"5.999",adj_Fat_TEE_slope_M:"12.474",N_F:"7",BodyMass_F:"50.19",Height_F:"158.5",BMI_F:"19.99",Fat_F:"23.08",TEE_F:"9.66",BEEmeas_F:null,BEEest_F:"5.27",AEE_F:"3.42",PAL_F:"1.85",adj_BMI_TEE_slope_F:"-3.901",adj_Fat_TEE_slope_F:"-2.222",PercUPF:null,UPF_source:"8",kg_meat:"7.62",meat_source:"2",lat:13.4432,lon:-15.3101},{Population:"Hadza",ISO:"HZA",HDI_score:null,HDI_rank:206,Economy:"HG",N_M:24,BodyMass_M:50.72,Height_M:null,BMI_M:null,Fat_M:13.17,TEE_M:10.47,BEEmeas_M:null,BEEest_M:"5.66",AEE_M:3.76,PAL_M:1.85,adj_BMI_TEE_slope_M:"1.314",adj_Fat_TEE_slope_M:"1.171",N_F:"20",BodyMass_F:"44.93",Height_F:"150.04",BMI_F:"19.92",Fat_F:"22.61",TEE_F:"7.97",BEEmeas_F:null,BEEest_F:"4.88",AEE_F:"2.29",PAL_F:"1.63",adj_BMI_TEE_slope_F:"10.838",adj_Fat_TEE_slope_F:"-0.391",PercUPF:"0",UPF_source:"9",kg_meat:"167.77",meat_source:"10",lat:-3.7,lon:35},{Population:"India",ISO:"IND",HDI_score:"0.633",HDI_rank:130,Economy:"midHDI",N_M:19,BodyMass_M:70.96,Height_M:"172.45",BMI_M:"23.93",Fat_M:26.04,TEE_M:8.99,BEEmeas_M:"6.9",BEEest_M:null,AEE_M:1.19,PAL_M:1.31,adj_BMI_TEE_slope_M:"8.033",adj_Fat_TEE_slope_M:"-9.311",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:20.5937,lon:78.9629},{Population:"Jamaica",ISO:"JAM",HDI_score:"0.709",HDI_rank:110,Economy:"midHDI",N_M:35,BodyMass_M:71.33,Height_M:"176.17",BMI_M:"22.86",Fat_M:20.91,TEE_M:10.5,BEEmeas_M:null,BEEest_M:"6.84",AEE_M:2.61,PAL_M:1.52,adj_BMI_TEE_slope_M:"-6.412",adj_Fat_TEE_slope_M:"4.125",N_F:"37",BodyMass_F:"75.61",Height_F:"163.37",BMI_F:"28.29",Fat_F:"39.42",TEE_F:"8.84",BEEmeas_F:null,BEEest_F:"6.03",AEE_F:"1.92",PAL_F:"1.46",adj_BMI_TEE_slope_F:"-3.833",adj_Fat_TEE_slope_F:"4.13",PercUPF:null,UPF_source:null,kg_meat:" 62.26",meat_source:" 2",lat:18.1096,lon:-77.2975},{Population:"Kenya",ISO:"KEN",HDI_score:"0.575",HDI_rank:150,Economy:"lowHDI",N_M:10,BodyMass_M:56.37,Height_M:"174.8",BMI_M:"18.46",Fat_M:6.21,TEE_M:14.46,BEEmeas_M:null,BEEest_M:"6.27",AEE_M:6.75,PAL_M:2.31,adj_BMI_TEE_slope_M:"24.803",adj_Fat_TEE_slope_M:"0.382",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:"8.1",UPF_source:"11",kg_meat:"14.91",meat_source:"2",lat:-.0236,lon:37.9062},{Population:"Nigeria",ISO:"NGA",HDI_score:"0.535",HDI_rank:163,Economy:"lowHDI",N_M:null,BodyMass_M:null,Height_M:null,BMI_M:null,Fat_M:null,TEE_M:null,BEEmeas_M:null,BEEest_M:null,AEE_M:null,PAL_M:null,adj_BMI_TEE_slope_M:null,adj_Fat_TEE_slope_M:null,N_F:"116",BodyMass_F:"58.42",Height_F:"160.81",BMI_F:"22.58",Fat_F:"29.17",TEE_F:"9.32",BEEmeas_F:null,BEEest_F:"5.45",AEE_F:"2.94",PAL_F:"1.71",adj_BMI_TEE_slope_F:"-9.775",adj_Fat_TEE_slope_F:"1.476",PercUPF:null,UPF_source:null,kg_meat:"9.32",meat_source:"2",lat:9.082,lon:8.6753},{Population:"Netherlands",ISO:"NLD",HDI_score:"0.941",HDI_rank:10,Economy:"highHDI",N_M:228,BodyMass_M:86.94,Height_M:"179.93",BMI_M:"26.82",Fat_M:26.76,TEE_M:13.83,BEEmeas_M:null,BEEest_M:"7.75",AEE_M:4.69,PAL_M:1.79,adj_BMI_TEE_slope_M:"2.871",adj_Fat_TEE_slope_M:"4.597",N_F:"202",BodyMass_F:"73.92",Height_F:"167.19",BMI_F:"26.49",Fat_F:"35.32",TEE_F:"10.94",BEEmeas_F:null,BEEest_F:"6.33",AEE_F:"3.52",PAL_F:"1.73",adj_BMI_TEE_slope_F:"15.251",adj_Fat_TEE_slope_F:"12.767",PercUPF:"37.0",UPF_source:"1",kg_meat:"84.25",meat_source:"2",lat:52.1326,lon:5.2913},{Population:"Norway",ISO:"NOR",HDI_score:"0.961",HDI_rank:1,Economy:"highHDI",N_M:12,BodyMass_M:87.1,Height_M:"180.58",BMI_M:"26.67",Fat_M:25.66,TEE_M:13.61,BEEmeas_M:null,BEEest_M:"7.71",AEE_M:4.55,PAL_M:1.77,adj_BMI_TEE_slope_M:"-7.027",adj_Fat_TEE_slope_M:"-2.487",N_F:"25",BodyMass_F:"66.95",Height_F:"169.38",BMI_F:"23.29",Fat_F:"28.1",TEE_F:"10.64",BEEmeas_F:null,BEEest_F:"6.19",AEE_F:"3.38",PAL_F:"1.71",adj_BMI_TEE_slope_F:"-11.99",adj_Fat_TEE_slope_F:"0.085",PercUPF:"36.9",UPF_source:"12",kg_meat:"68.37",meat_source:"2",lat:60.472,lon:8.4689},{Population:"Nepal",ISO:"NPL",HDI_score:"0.605",HDI_rank:144,Economy:"lowHDI",N_M:3,BodyMass_M:64.33,Height_M:"175.0",BMI_M:"20.92",Fat_M:16.65,TEE_M:13.56,BEEmeas_M:"6.03",BEEest_M:null,AEE_M:6.17,PAL_M:2.24,adj_BMI_TEE_slope_M:"-0.704",adj_Fat_TEE_slope_M:"-5.357",N_F:"2",BodyMass_F:"54.0",Height_F:"165.0",BMI_F:"19.94",Fat_F:"24.93",TEE_F:"10.37",BEEmeas_F:"6.0",BEEest_F:null,AEE_F:"3.34",PAL_F:"1.73",adj_BMI_TEE_slope_F:"-9.146",adj_Fat_TEE_slope_F:"-25.798",PercUPF:null,UPF_source:null,kg_meat:"12.09",meat_source:"2",lat:28.3949,lon:84.124},{Population:"Rwanda",ISO:"RWA",HDI_score:"0.534",HDI_rank:165,Economy:"lowHDI",N_M:null,BodyMass_M:null,Height_M:null,BMI_M:null,Fat_M:null,TEE_M:null,BEEmeas_M:null,BEEest_M:null,AEE_M:null,PAL_M:null,adj_BMI_TEE_slope_M:null,adj_Fat_TEE_slope_M:null,N_F:"8",BodyMass_F:"60.26",Height_F:"160.93",BMI_F:"23.36",Fat_F:"31.49",TEE_F:"13.54",BEEmeas_F:null,BEEest_F:"5.6",AEE_F:"6.59",PAL_F:"2.42",adj_BMI_TEE_slope_F:"12.314",adj_Fat_TEE_slope_F:"1.073",PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:-1.9403,lon:29.8739},{Population:"Singapore",ISO:"SGP",HDI_score:"0.939",HDI_rank:10,Economy:"highHDI",N_M:56,BodyMass_M:86.32,Height_M:"173.68",BMI_M:"28.59",Fat_M:32.74,TEE_M:11.71,BEEmeas_M:null,BEEest_M:"7.2",AEE_M:3.34,PAL_M:1.63,adj_BMI_TEE_slope_M:"5.335",adj_Fat_TEE_slope_M:"3.277",N_F:null,BodyMass_F:null,Height_F:null,BMI_F:null,Fat_F:null,TEE_F:null,BEEmeas_F:null,BEEest_F:null,AEE_F:null,PAL_F:null,adj_BMI_TEE_slope_F:null,adj_Fat_TEE_slope_F:null,PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:1.3521,lon:103.8198},{Population:"Shuar",ISO:"SHR",HDI_score:null,HDI_rank:203,Economy:"HORT",N_M:5,BodyMass_M:74.5,Height_M:"163.42",BMI_M:"27.8",Fat_M:20.07,TEE_M:16.32,BEEmeas_M:null,BEEest_M:"7.19",AEE_M:7.5,PAL_M:2.26,adj_BMI_TEE_slope_M:"-23.681",adj_Fat_TEE_slope_M:"3.66",N_F:"8",BodyMass_F:"58.96",Height_F:"150.98",BMI_F:"25.81",Fat_F:"27.69",TEE_F:"10.59",BEEmeas_F:null,BEEest_F:"5.69",AEE_F:"3.83",PAL_F:"1.86",adj_BMI_TEE_slope_F:"-14.68",adj_Fat_TEE_slope_F:"-5.394",PercUPF:"2.5",UPF_source:"13",kg_meat:"1.29",meat_source:"14",lat:-2.75,lon:-78.0833},{Population:"Sweden",ISO:"SWE",HDI_score:"0.947",HDI_rank:9,Economy:"highHDI",N_M:16,BodyMass_M:69.53,Height_M:"179.13",BMI_M:"21.68",Fat_M:16.91,TEE_M:14.34,BEEmeas_M:null,BEEest_M:"7.33",AEE_M:5.57,PAL_M:1.97,adj_BMI_TEE_slope_M:"3.385",adj_Fat_TEE_slope_M:"2.187",N_F:"47",BodyMass_F:"70.45",Height_F:"168.0",BMI_F:"24.95",Fat_F:"30.54",TEE_F:"10.87",BEEmeas_F:null,BEEest_F:"6.29",AEE_F:"3.49",PAL_F:"1.73",adj_BMI_TEE_slope_F:"-5.313",adj_Fat_TEE_slope_F:"-0.893",PercUPF:"42.2",UPF_source:"7",kg_meat:"80.51",meat_source:"2",lat:60.1282,lon:18.6435},{Population:"Seychelles",ISO:"SYC",HDI_score:"0.785",HDI_rank:69,Economy:"midHDI",N_M:31,BodyMass_M:72.64,Height_M:"169.93",BMI_M:"25.14",Fat_M:22.99,TEE_M:11.99,BEEmeas_M:"6.89",BEEest_M:null,AEE_M:3.9,PAL_M:1.74,adj_BMI_TEE_slope_M:"-17.515",adj_Fat_TEE_slope_M:"-6.717",N_F:"41",BodyMass_F:"76.06",Height_F:"163.51",BMI_F:"28.37",Fat_F:"40.11",TEE_F:"9.44",BEEmeas_F:"5.94",BEEest_F:null,AEE_F:"2.55",PAL_F:"1.59",adj_BMI_TEE_slope_F:"2.457",adj_Fat_TEE_slope_F:"8.738",PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:-4.6796,lon:55.492},{Population:"Thailand",ISO:"THA",HDI_score:"0.8",HDI_rank:64,Economy:"highHDI",N_M:23,BodyMass_M:62.2,Height_M:"166.52",BMI_M:"22.45",Fat_M:22.63,TEE_M:8.7,BEEmeas_M:"5.92",BEEest_M:"",AEE_M:1.91,PAL_M:1.48,adj_BMI_TEE_slope_M:"0.835",adj_Fat_TEE_slope_M:"1.701",N_F:"25",BodyMass_F:"53.03",Height_F:"158.48",BMI_F:"21.08",Fat_F:"31.55",TEE_F:"6.93",BEEmeas_F:"4.6",BEEest_F:null,AEE_F:"1.64",PAL_F:"1.51",adj_BMI_TEE_slope_F:"-13.947",adj_Fat_TEE_slope_F:"1.017",PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:15.87,lon:100.9925},{Population:"Tsimane",ISO:"TSM",HDI_score:null,HDI_rank:201,Economy:"HORT",N_M:16,BodyMass_M:64.3,Height_M:"162.27",BMI_M:"24.28",Fat_M:21.34,TEE_M:12.58,BEEmeas_M:null,BEEest_M:"7.79",AEE_M:3.53,PAL_M:1.64,adj_BMI_TEE_slope_M:"21.184",adj_Fat_TEE_slope_M:"3.303",N_F:"16",BodyMass_F:"52.86",Height_F:"150.74",BMI_F:"23.41",Fat_F:"29.4",TEE_F:"9.43",BEEmeas_F:null,BEEest_F:"6.11",AEE_F:"2.38",PAL_F:"1.56",adj_BMI_TEE_slope_F:"13.978",adj_Fat_TEE_slope_F:"-6.71",PercUPF:"2.5",UPF_source:"Obs.",kg_meat:null,meat_source:null,lat:-14.9167,lon:-66.0833},{Population:"Tuva",ISO:"TVA",HDI_score:null,HDI_rank:202,Economy:"AGP",N_M:9,BodyMass_M:64.64,Height_M:null,BMI_M:null,Fat_M:22.48,TEE_M:14.06,BEEmeas_M:null,BEEest_M:"6.37",AEE_M:6.28,PAL_M:2.21,adj_BMI_TEE_slope_M:"-23.8",adj_Fat_TEE_slope_M:"",N_F:"3",BodyMass_F:"62.8",Height_F:null,BMI_F:null,Fat_F:"38.88",TEE_F:"13.86",BEEmeas_F:null,BEEest_F:"5.36",AEE_F:"7.11",PAL_F:"2.57",adj_BMI_TEE_slope_F:"13.129",adj_Fat_TEE_slope_F:null,PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:52,lon:95},{Population:"United States",ISO:"USA",HDI_score:"0.921",HDI_rank:21,Economy:"highHDI",N_M:740,BodyMass_M:86.24,Height_M:null,BMI_M:null,Fat_M:28.03,TEE_M:12.63,BEEmeas_M:null,BEEest_M:"7.43",AEE_M:3.93,PAL_M:1.69,adj_BMI_TEE_slope_M:"-5.664",adj_Fat_TEE_slope_M:"-0.743",N_F:"1869",BodyMass_F:"78.02",Height_F:"164.49",BMI_F:"28.83",Fat_F:"38.77",TEE_F:"9.9",BEEmeas_F:null,BEEest_F:"6.09",AEE_F:"2.82",PAL_F:"1.63",adj_BMI_TEE_slope_F:"-0.239",adj_Fat_TEE_slope_F:"-1.859",PercUPF:"55.5",UPF_source:"1",kg_meat:"115.44",meat_source:"2",lat:37.0902,lon:-95.7129},{Population:"Yakut",ISO:"YAK",HDI_score:null,HDI_rank:200,Economy:"lowHDI",N_M:14,BodyMass_M:72.19,Height_M:"169.48",BMI_M:"25.12",Fat_M:25.26,TEE_M:13.29,BEEmeas_M:"7.73",BEEest_M:null,AEE_M:4.22,PAL_M:1.72,adj_BMI_TEE_slope_M:"-0.358",adj_Fat_TEE_slope_M:"6.245",N_F:"14",BodyMass_F:"65.19",Height_F:"155.34",BMI_F:"26.91",Fat_F:"41.44",TEE_F:"9.81",BEEmeas_F:"6.42",BEEest_F:null,AEE_F:"2.41",PAL_F:"1.53",adj_BMI_TEE_slope_F:"36.488",adj_Fat_TEE_slope_F:"26.96",PercUPF:null,UPF_source:null,kg_meat:null,meat_source:null,lat:62,lon:129},{Population:"South Africa",ISO:"ZAF",HDI_score:"0.713",HDI_rank:102,Economy:"midHDI",N_M:37,BodyMass_M:62.03,Height_M:"169.16",BMI_M:"21.68",Fat_M:23.11,TEE_M:10.04,BEEmeas_M:null,BEEest_M:"6.37",AEE_M:2.67,PAL_M:1.59,adj_BMI_TEE_slope_M:"-7.929",adj_Fat_TEE_slope_M:"-2.365",N_F:"59",BodyMass_F:"83.05",Height_F:"160.54",BMI_F:"32.06",Fat_F:"44.11",TEE_F:"9.97",BEEmeas_F:null,BEEest_F:"6.28",AEE_F:"2.69",PAL_F:"1.6",adj_BMI_TEE_slope_F:"1.38",adj_Fat_TEE_slope_F:"-0.447",PercUPF:"39.4",UPF_source:"15",kg_meat:"61.54",meat_source:"2",lat:-30.5595,lon:22.9375}],ft=d3.select("body").append("div").attr("class","chart-tooltip").style("position","absolute");function ot(e,a,n,o,l=0){const t=e.append("g").attr("transform",`translate(${a}, ${n})${l?` rotate(${l})`:""}`).style("cursor","pointer");return t.append("circle").attr("cx",0).attr("cy",0).attr("r",7).attr("fill","#6b7280").attr("stroke","#fff").attr("stroke-width",1.5),t.append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("dominant-baseline","central").attr("font-size","10px").attr("font-weight","700").attr("fill","#fff").text("?"),t.on("mouseover",function(s){ft.html(o).style("left",s.pageX+10+"px").style("top",s.pageY-10+"px").classed("visible",!0)}).on("mouseout",function(){ft.classed("visible",!1)}),t}let E={xVar:"upf",yVar:"bodyFat",economies:["highHDI","AGP","midHDI","HG","lowHDI","HORT"],sexes:["M","F"],highlightedPopulations:[],chartType:"auto"};const K={highHDI:"#3b82f6",midHDI:"#14b8a6",lowHDI:"#84cc16",AGP:"#f97316",HORT:"#fbbf24",HG:"#dc2626"},dt=["highHDI","midHDI","lowHDI","HORT","AGP","HG"],Et={highHDI:"high HDI",midHDI:"mid HDI",lowHDI:"low HDI",HG:"hunter-gatherer",HORT:"horticulturalist",AGP:"agropastoralist"},Ht={HG:"Hunter-gatherer: living by hunting, fishing, and foraging rather than farming.",AGP:"Pastoralist / agropastoralist: herding livestock as the core of daily life.",HORT:"Horticulturalist: small-scale farming using manual tools.",lowHDI:"Small-scale agriculturalist: farming with limited mechanization.",midHDI:"Industrialized: living in modern economies with wage labor, markets, and high integration into national infrastructure.",highHDI:"Industrialized: living in modern economies with wage labor, markets, and high integration into national infrastructure."},P=d3.select("body").append("div").attr("class","map-tooltip").style("position","absolute").style("visibility","hidden").style("background-color","rgba(0, 0, 0, 0.9)").style("color","#fff").style("padding","10px 14px").style("border-radius","6px").style("font-size","13px").style("line-height","1.5").style("pointer-events","none").style("z-index","1000").style("box-shadow","0 2px 8px rgba(0,0,0,0.3)").style("max-width","320px");function At(e){const a=document.getElementById(e);a.innerHTML="";const n=a.clientWidth||800,o=500,t=n-230-40,s=d3.select(`#${e}`).append("svg").attr("width",n).attr("height",o),_=d3.geoNaturalEarth1().scale(t/5.5).translate([t/2,o/1.9]),u=d3.geoPath().projection(_);d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(m=>{const p=topojson.feature(m,m.objects.countries),f=s.append("g");f.append("g").selectAll("path").data(p.features).join("path").attr("d",u).attr("fill","#2d3748").attr("stroke","#4a5568").attr("stroke-width",.5);const v=d3.max(lt,r=>(Number(r.N_M)||0)+(Number(r.N_F)||0)),I=d3.scaleSqrt().domain([0,v]).range([3,16]);lt.forEach(r=>{const y=Number(r.lat),x=Number(r.lon),b=(Number(r.N_M)||0)+(Number(r.N_F)||0),[j,i]=_([x,y]);f.append("circle").attr("cx",j).attr("cy",i).attr("r",I(b)).attr("fill",K[r.Economy]).attr("stroke","#fff").attr("stroke-width",1.5).attr("opacity",.85).style("cursor","pointer").on("mouseover",function(F){d3.select(this).transition().duration(120).attr("r",I(b)+3).attr("opacity",1);let c=`<strong>${r.Population}</strong><br>`;c+=`<strong>Economy:</strong> ${Et[r.Economy]}<br>`,r.HDI_score&&(c+=`<strong>HDI:</strong> ${r.HDI_score} (rank ${r.HDI_rank})<br>`),c+="<br><strong>Sample Sizes:</strong><br>",r.N_M&&(c+=`Male: ${r.N_M}<br>`),r.N_F&&(c+=`Female: ${r.N_F}<br>`),c+=`Total: ${b}<br>`,c+="<br><strong>Measurements:</strong><br>",(r.Fat_M||r.Fat_F)&&(c+="<strong>Body Fat %:</strong> ",r.Fat_M&&r.Fat_F?c+=`M: ${Number(r.Fat_M).toFixed(1)}%, F: ${Number(r.Fat_F).toFixed(1)}%<br>`:r.Fat_M?c+=`M: ${Number(r.Fat_M).toFixed(1)}%<br>`:c+=`F: ${Number(r.Fat_F).toFixed(1)}%<br>`),(r.PAL_M||r.PAL_F)&&(c+="<strong>PAL:</strong> ",r.PAL_M&&r.PAL_F?c+=`M: ${Number(r.PAL_M).toFixed(2)}, F: ${Number(r.PAL_F).toFixed(2)}<br>`:r.PAL_M?c+=`M: ${Number(r.PAL_M).toFixed(2)}<br>`:c+=`F: ${Number(r.PAL_F).toFixed(2)}<br>`),(r.TEE_M||r.TEE_F)&&(c+="<strong>TEE (MJ/day):</strong> ",r.TEE_M&&r.TEE_F?c+=`M: ${Number(r.TEE_M).toFixed(1)}, F: ${Number(r.TEE_F).toFixed(1)}<br>`:r.TEE_M?c+=`M: ${Number(r.TEE_M).toFixed(1)}<br>`:c+=`F: ${Number(r.TEE_F).toFixed(1)}<br>`),r.PercUPF&&(c+=`<strong>UPF %:</strong> ${r.PercUPF}%<br>`),P.html(c).style("visibility","visible")}).on("mousemove",function(F){P.style("top",F.pageY-10+"px").style("left",F.pageX+10+"px")}).on("mouseout",function(){d3.select(this).transition().duration(120).attr("r",I(b)).attr("opacity",.85),P.style("visibility","hidden")})});const S=s.append("g").attr("transform",`translate(${t+20}, 20)`);S.append("text").attr("x",0).attr("y",0).attr("font-size","14px").attr("font-weight","700").attr("fill","#2d1810").text("Economy Type"),dt.forEach((r,y)=>{const x=S.append("g").attr("transform",`translate(0, ${20+y*24})`);x.append("circle").attr("cx",8).attr("cy",0).attr("r",6).attr("fill",K[r]).attr("stroke","#fff").attr("stroke-width",1.5);const j=x.append("text").attr("x",22).attr("y",4).attr("font-size","12px").attr("fill","#2d1810").text(Et[r]).node().getComputedTextLength();ot(x,22+j+8,0,Ht[r])});const H=s.append("g").attr("transform",`translate(${t+20}, ${20+dt.length*24+40})`);H.append("text").attr("x",0).attr("y",0).attr("font-size","14px").attr("font-weight","700").attr("fill","#2d1810").text("Sample Size"),[10,50,100,500,1e3,2e3].filter(r=>r<=v).forEach((r,y)=>{const x=H.append("g").attr("transform",`translate(0, ${20+y*24})`),b=I(r);x.append("circle").attr("cx",8).attr("cy",0).attr("r",b).attr("fill","#9ca3af").attr("stroke","#fff").attr("stroke-width",1.5).attr("opacity",.7),x.append("text").attr("x",22).attr("y",4).attr("font-size","12px").attr("fill","#2d1810").text(`n = ${r}`)})})}function kt(e,a=["United States"],n="adults",o=1975,l=2022,t=null){const s=document.getElementById(e);s.innerHTML="";const _={top:40,right:120,bottom:50,left:60},u=(s.clientWidth||600)-_.left-_.right,m=350-_.top-_.bottom,p=d3.select(`#${e}`).append("svg").attr("width",u+_.left+_.right).attr("height",m+_.top+_.bottom).append("g").attr("transform",`translate(${_.left},${_.top})`);p.append("text").attr("x",0).attr("y",-20).attr("text-anchor","start").attr("font-size","16px").attr("font-weight","700").attr("fill","#5c2e1e").text(`Obesity Trends: ${n.charAt(0).toUpperCase()+n.slice(1)} (${o}â€“${l})`);const f=vt.filter(y=>y>=o&&y<=l),v=a.map(y=>({country:y,values:f.map(x=>({year:x,obesity:Tt(y,x,n)}))})),I=d3.scaleLinear().domain([o,l]).range([0,u]),S=d3.max(v,y=>d3.max(y.values,x=>x.obesity)),H=d3.scaleLinear().domain([0,Math.ceil(S/5)*5]).range([m,0]),V=d3.scaleOrdinal().domain(a).range(["#dc2626","#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316"]),W=d3.line().x(y=>I(y.year)).y(y=>H(y.obesity)).curve(d3.curveMonotoneX);if(v.forEach((y,x)=>{const b=y.country==="United States";p.append("path").datum(y.values).attr("fill","none").attr("stroke",V(y.country)).attr("stroke-width",b?4:2).attr("stroke-opacity",b?1:.8).attr("d",W),p.selectAll(`.dot-${x}`).data(y.values).join("circle").attr("class",`dot-${x}`).attr("cx",j=>I(j.year)).attr("cy",j=>H(j.obesity)).attr("r",b?5:3).attr("fill",V(y.country)).attr("stroke","#fff").attr("stroke-width",b?2:1).append("title").text(j=>`${y.country}
${j.year}: ${j.obesity.toFixed(1)}%`)}),t!==null&&t>=o&&t<=l){const y=p.append("g").attr("class","year-indicator");y.append("line").attr("x1",I(t)).attr("x2",I(t)).attr("y1",0).attr("y2",m).attr("stroke","#5c2e1e").attr("stroke-width",3).attr("stroke-dasharray","8,4").attr("opacity",.7),y.append("text").attr("x",I(t)).attr("y",-5).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","700").attr("fill","#5c2e1e").text(t)}p.append("g").attr("transform",`translate(0,${m})`).call(d3.axisBottom(I).tickFormat(d3.format("d"))).selectAll("text").attr("font-family","Fredoka").attr("font-weight","600"),p.append("text").attr("x",u/2).attr("y",m+40).attr("text-anchor","middle").attr("font-family","Fredoka").attr("font-size","14px").attr("font-weight","700").attr("fill","#5c2e1e").text("Year"),p.append("g").call(d3.axisLeft(H).tickFormat(y=>y+"%")).selectAll("text").attr("font-family","Fredoka").attr("font-weight","600"),p.append("text").attr("transform","rotate(-90)").attr("x",-m/2).attr("y",-45).attr("text-anchor","middle").attr("font-family","Fredoka").attr("font-size","14px").attr("font-weight","700").attr("fill","#5c2e1e").text("Obesity Rate");const r=p.append("g").attr("transform",`translate(${u+20}, 0)`);v.forEach((y,x)=>{const b=y.country==="United States",j=r.append("g").attr("transform",`translate(0, ${x*25})`);j.append("line").attr("x1",0).attr("x2",20).attr("y1",10).attr("y2",10).attr("stroke",V(y.country)).attr("stroke-width",b?4:2),j.append("text").attr("x",25).attr("y",14).attr("font-family","Fredoka").attr("font-size","12px").attr("font-weight",b?"700":"500").attr("fill","#5c2e1e").text(y.country)})}const C={TEE:{male:"TEE_M",female:"TEE_F",label:"TEE (MJ/day)",tooltip:"Total Energy Expenditure in megajoules per day"},PAL:{male:"PAL_M",female:"PAL_F",label:"PAL",tooltip:"Physical Activity Level ratio"},PercUPF:{male:"PercUPF",female:"PercUPF",label:"UPF (%)",tooltip:"Percentage of energy from ultra-processed foods"},Fat:{male:"Fat_M",female:"Fat_F",label:"Body Fat (%)",tooltip:"Body fat percentage"},Economy_Type:{male:"Economy",female:"Economy",label:"Economy Type",tooltip:"Economy type classification based on HDI and subsistence strategy"},HDI_rank:{male:"HDI_rank",female:"HDI_rank",label:"HDI Rank",tooltip:"Human Development Index ranking (lower is better)"}};function mt(e){const a=document.getElementById(e);a.innerHTML="";const n={top:60,right:180,bottom:60,left:60},o=(a.clientWidth||600)-n.left-n.right,l=500-n.top-n.bottom,t=d3.select(`#${e}`).append("svg").attr("width",o+n.left+n.right).attr("height",l+n.top+n.bottom).append("g").attr("transform",`translate(${n.left},${n.top})`);function s(i){if(i==null)return null;if(typeof i=="string"){const c=i.trim().toUpperCase();if(c===""||c==="NA"||c==="NULL")return null}const F=Number(i);return Number.isFinite(F)?F:null}function _(i,F,c){const h=C[F];return h?h.male===h.female?s(i[h.male]):s(c==="M"?i[h.male]:i[h.female]):null}const u=E.chartType==="box"||E.chartType==="auto"&&E.xVar==="Economy_Type",m=[],p=E.xVar==="Economy_Type";lt.forEach(i=>{if(E.sexes.includes("M")){const F=_(i,E.xVar,"M"),c=_(i,E.yVar,"M");(p||F!==null)&&c!==null&&m.push({Population:i.Population,Economy:i.Economy,sex:"M",xVal:F,yVal:c,HDI_rank:+i.HDI_rank,lat:i.lat,lon:i.lon})}if(E.sexes.includes("F")){const F=_(i,E.xVar,"F"),c=_(i,E.yVar,"F");(p||F!==null)&&c!==null&&m.push({Population:i.Population,Economy:i.Economy,sex:"F",xVal:F,yVal:c,HDI_rank:+i.HDI_rank,lat:i.lat,lon:i.lon})}});const f=m.filter(i=>E.economies.includes(i.Economy));if(f.length===0){t.append("text").attr("x",o/2).attr("y",l/2).attr("text-anchor","middle").attr("font-size","16px").attr("fill","#666").text("No data available for selected filters");return}const v=E.highlightedPopulations||[];let I=!1,S=!1;const H=[];lt.forEach(i=>{if(!E.economies.includes(i.Economy))return;const F=E.sexes.includes("M")&&_(i,E.xVar,"M")!==null,c=E.sexes.includes("M")&&_(i,E.yVar,"M")!==null,h=E.sexes.includes("F")&&_(i,E.xVar,"F")!==null,g=E.sexes.includes("F")&&_(i,E.yVar,"F")!==null,D=(p||F)&&c,G=(p||h)&&g;E.sexes.includes("M")&&!D&&H.push({Population:i.Population,Economy:i.Economy,sex:"M"}),E.sexes.includes("F")&&!G&&H.push({Population:i.Population,Economy:i.Economy,sex:"F"})});let V=0,W=0;if(u){const i=d3.group(f,M=>M.Economy),F=dt.filter(M=>E.economies.includes(M)).map(M=>{const B=(i.get(M)||[]).map(z=>z.yVal).sort(d3.ascending);if(B.length===0)return null;const k=d3.quantile(B,.25),A=d3.quantile(B,.5),d=d3.quantile(B,.75),O=d-k,q=Math.max(d3.min(B),k-1.5*O),w=Math.min(d3.max(B),d+1.5*O);return{economy:M,q1:k,median:A,q3:d,min:q,max:w,values:B,data:i.get(M)}}).filter(M=>M!==null),c=d3.scaleBand().domain(F.map(M=>M.economy)).range([0,o]).padding(.3),h=F.flatMap(M=>M.values),g=d3.scaleLinear().domain(d3.extent(h)).nice().range([l,0]);F.forEach(M=>{const B=c(M.economy)+c.bandwidth()/2,k=c.bandwidth();t.append("line").attr("x1",B).attr("x2",B).attr("y1",g(M.min)).attr("y2",g(M.q1)).attr("stroke","#374151").attr("stroke-width",1.5),t.append("line").attr("x1",B).attr("x2",B).attr("y1",g(M.q3)).attr("y2",g(M.max)).attr("stroke","#374151").attr("stroke-width",1.5),t.append("line").attr("x1",B-k/4).attr("x2",B+k/4).attr("y1",g(M.min)).attr("y2",g(M.min)).attr("stroke","#374151").attr("stroke-width",2),t.append("line").attr("x1",B-k/4).attr("x2",B+k/4).attr("y1",g(M.max)).attr("y2",g(M.max)).attr("stroke","#374151").attr("stroke-width",2),t.append("rect").attr("x",B-k/2).attr("y",g(M.q3)).attr("width",k).attr("height",g(M.q1)-g(M.q3)).attr("fill",K[M.economy]).attr("stroke","#374151").attr("stroke-width",1.5),t.append("line").attr("x1",B-k/2).attr("x2",B+k/2).attr("y1",g(M.median)).attr("y2",g(M.median)).attr("stroke","#374151").attr("stroke-width",2.5),M.data.forEach(A=>{const d=v.includes(A.Population),q=(A.Population+A.sex).split("").reduce(($,J)=>$+J.charCodeAt(0),0)%1e3/1e3,w=B+(q-.5)*k*.3,z=g(A.yVal),U=d?8:6,R=d?1:.85,N=d?3:1.5,X=d?"#000":"#fff",st=`
          <strong>${A.Population}</strong><br>
          Sex: ${A.sex==="M"?"Male":"Female"}<br>
          ${C[E.yVar].label}: ${A.yVal.toFixed(2)}
        `;if(A.sex==="M")t.append("circle").attr("cx",w).attr("cy",z).attr("r",U).attr("fill",K[A.Economy]).attr("stroke",X).attr("stroke-width",N).attr("opacity",R).style("cursor","pointer").on("mouseover",function($){d3.select(this).attr("r",U+2).attr("opacity",1),P.html(st).style("visibility","visible")}).on("mousemove",function($){P.style("top",$.pageY-10+"px").style("left",$.pageX+10+"px")}).on("mouseout",function(){d3.select(this).attr("r",U).attr("opacity",R),P.style("visibility","hidden")}).on("click",function(){it(A.Population)});else{const $=d?100:60;t.append("path").attr("d",d3.symbol().type(d3.symbolTriangle).size($)).attr("transform",`translate(${w},${z})`).attr("fill",K[A.Economy]).attr("stroke",X).attr("stroke-width",N).attr("opacity",R).style("cursor","pointer").on("mouseover",function(J){d3.select(this).attr("d",d3.symbol().type(d3.symbolTriangle).size($*1.5)).attr("opacity",1),P.html(st).style("visibility","visible")}).on("mousemove",function(J){P.style("top",J.pageY-10+"px").style("left",J.pageX+10+"px")}).on("mouseout",function(){d3.select(this).attr("d",d3.symbol().type(d3.symbolTriangle).size($)).attr("opacity",R),P.style("visibility","hidden")}).on("click",function(){it(A.Population)})}})}),t.append("g").attr("transform",`translate(0,${l})`).call(d3.axisBottom(c)).selectAll("text").attr("font-size","12px").attr("font-weight","600"),t.append("g").call(d3.axisLeft(g)).selectAll("text").attr("font-size","12px").attr("font-weight","600");const D=t.append("g").attr("transform",`translate(${o/2}, ${l+45})`);D.append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("font-size","14px").attr("font-weight","700").attr("fill","#2d1810").text("Economy"),ot(D,50,-5,"Economy type classification based on HDI and subsistence strategy");const G=t.append("g").attr("transform",`rotate(-90) translate(${-l/2}, -45)`);G.append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("font-size","14px").attr("font-weight","700").attr("fill","#2d1810").text(C[E.yVar].label),ot(G,80,-5,C[E.yVar].tooltip)}else{let B=function(d,O){if(d.length<2)return{hasLine:!1,r:0};const q=d3.mean(d,Y=>Y.xVal),w=d3.mean(d,Y=>Y.yVal);let z=0,U=0,R=0;if(d.forEach(Y=>{const Ft=Y.xVal-q,Mt=Y.yVal-w;z+=Ft*Mt,U+=Ft**2,R+=Mt**2}),U===0)return{hasLine:!1,r:0};const N=z/U,X=w-N*q,st=U>0&&R>0?z/Math.sqrt(U*R):0,$=d3.min(d,Y=>Y.xVal),J=d3.max(d,Y=>Y.xVal),bt=t.append("line").attr("x1",g($)).attr("x2",g(J)).attr("y1",D(N*$+X)).attr("y2",D(N*J+X)).attr("stroke","#4b5563").attr("stroke-width",2).attr("opacity",.9);return O&&bt.attr("stroke-dasharray","5 4"),{hasLine:!0,r:st}};var j=B;const i=d3.extent(f,d=>d.xVal),F=d3.extent(f,d=>d.yVal),c=(i[1]-i[0])*.1,h=(F[1]-F[0])*.1,g=d3.scaleLinear().domain([Math.max(0,i[0]-c),i[1]+c]).range([0,o]),D=d3.scaleLinear().domain([Math.max(0,F[0]-h),F[1]+h]).range([l,0]);f.forEach(d=>{d.xPosition=g(d.xVal)});const G=f.filter(d=>d.sex==="M"),M=f.filter(d=>d.sex==="F");if(E.sexes.includes("M")){const d=B(G,!0);I=d.hasLine,V=d.r}if(E.sexes.includes("F")){const d=B(M,!1);S=d.hasLine,W=d.r}f.forEach(d=>{const O=v.includes(d.Population),q=O?9:7,w=O?1:.85,z=O?3:1.5,U=O?"#000":"#fff",R=`
        <strong>${d.Population}</strong><br>
        Sex: ${d.sex==="M"?"Male":"Female"}<br>
        ${C[E.xVar].label}: ${d.xVal.toFixed(2)}<br>
        ${C[E.yVar].label}: ${d.yVal.toFixed(2)}
      `;if(d.sex==="M")t.append("circle").attr("cx",d.xPosition).attr("cy",D(d.yVal)).attr("r",q).attr("fill",K[d.Economy]).attr("stroke",U).attr("stroke-width",z).attr("opacity",w).style("cursor","pointer").on("mouseover",function(N){d3.select(this).attr("r",q+2).attr("opacity",1),P.html(R).style("visibility","visible")}).on("mousemove",function(N){P.style("top",N.pageY-10+"px").style("left",N.pageX+10+"px")}).on("mouseout",function(){d3.select(this).attr("r",q).attr("opacity",w),P.style("visibility","hidden")}).on("click",function(){it(d.Population)});else{const N=O?140:100;t.append("path").attr("d",d3.symbol().type(d3.symbolTriangle).size(N)).attr("transform",`translate(${d.xPosition},${D(d.yVal)})`).attr("fill",K[d.Economy]).attr("stroke",U).attr("stroke-width",z).attr("opacity",w).style("cursor","pointer").on("mouseover",function(X){d3.select(this).attr("d",d3.symbol().type(d3.symbolTriangle).size(N*1.4)).attr("opacity",1),P.html(R).style("visibility","visible")}).on("mousemove",function(X){P.style("top",X.pageY-10+"px").style("left",X.pageX+10+"px")}).on("mouseout",function(){d3.select(this).attr("d",d3.symbol().type(d3.symbolTriangle).size(N)).attr("opacity",w),P.style("visibility","hidden")}).on("click",function(){it(d.Population)})}}),t.append("g").attr("transform",`translate(0,${l})`).call(d3.axisBottom(g).ticks(8)).selectAll("text").attr("font-size","12px").attr("font-weight","600"),t.append("g").call(d3.axisLeft(D).ticks(8)).selectAll("text").attr("font-size","12px").attr("font-weight","600");const k=t.append("g").attr("transform",`translate(${o/2}, ${l+45})`);k.append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("font-size","14px").attr("font-weight","700").attr("fill","#2d1810").text(C[E.xVar].label),ot(k,60,-5,C[E.xVar].tooltip);const A=t.append("g").attr("transform",`rotate(-90) translate(${-l/2}, -45)`);A.append("text").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("font-size","14px").attr("font-weight","700").attr("fill","#2d1810").text(C[E.yVar].label),ot(A,80,-5,C[E.yVar].tooltip)}const r=t.append("g").attr("transform",`translate(${o+20}, -40)`);r.append("text").attr("x",0).attr("y",0).attr("font-size","16px").attr("font-weight","700").attr("fill","#000").text("Economy"),[{key:"highHDI",label:"high HDI"},{key:"midHDI",label:"mid HDI"},{key:"lowHDI",label:"low HDI"},{key:"HORT",label:"horticulturalist"},{key:"AGP",label:"agropastoralist"},{key:"HG",label:"hunter-gatherer"}].forEach((i,F)=>{if(!E.economies.includes(i.key))return;const c=r.append("g").attr("transform",`translate(0, ${25+F*25})`);c.append("circle").attr("cx",8).attr("cy",0).attr("r",6).attr("fill",K[i.key]).attr("stroke","none"),c.append("text").attr("x",22).attr("y",5).attr("font-size","14px").attr("fill","#000").text(i.label)});const x=t.append("g").attr("transform",`translate(${o+20}, 180)`);x.append("text").attr("x",0).attr("y",0).attr("font-size","16px").attr("font-weight","700").attr("fill","#000").text("Sex");let b=25;if(E.sexes.includes("M")){const i=x.append("g").attr("transform",`translate(0, ${b})`);i.append("circle").attr("cx",8).attr("cy",0).attr("r",6).attr("fill","#6b7280").attr("stroke","none"),i.append("text").attr("x",22).attr("y",5).attr("font-size","14px").attr("fill","#000").text("Male"),b+=25}if(E.sexes.includes("F")){const i=x.append("g").attr("transform",`translate(0, ${b})`);i.append("path").attr("d",d3.symbol().type(d3.symbolTriangle).size(50)).attr("transform","translate(8, 0)").attr("fill","#6b7280").attr("stroke","none"),i.append("text").attr("x",22).attr("y",5).attr("font-size","14px").attr("fill","#000").text("Female"),b+=25}if(!u&&(I||S)){const i=t.append("g").attr("transform",`translate(${o+20}, ${180+b+10})`);i.append("text").attr("x",0).attr("y",0).attr("font-size","16px").attr("font-weight","700").attr("fill","#000").text("Regression");let F=25;if(I){const c=i.append("g").attr("transform",`translate(0, ${F})`);c.append("line").attr("x1",0).attr("x2",28).attr("y1",0).attr("y2",0).attr("stroke","#4b5563").attr("stroke-width",2).attr("stroke-dasharray","5 4"),c.append("text").attr("x",36).attr("y",4).attr("font-size","14px").attr("fill","#000").text(`Male (r=${V.toFixed(2)})`),F+=25}if(S){const c=i.append("g").attr("transform",`translate(0, ${F})`);c.append("line").attr("x1",0).attr("x2",28).attr("y1",0).attr("y2",0).attr("stroke","#4b5563").attr("stroke-width",2),c.append("text").attr("x",36).attr("y",4).attr("font-size","14px").attr("fill","#000").text(`Female (r=${W.toFixed(2)})`)}}if(d3.select(".no-data-section").remove(),H.length>0){const i=d3.select(`#${e}`).node().parentNode,F=d3.select(i).append("div").attr("class","no-data-section").style("margin-top","10px").style("padding","10px 15px").style("background","rgba(0, 0, 0, 0.05)").style("border-radius","6px").style("font-size","12px");F.append("div").style("font-weight","600").style("margin-bottom","8px").style("color","#666").text("Missing data for current metrics:");const c=F.append("div").style("display","flex").style("flex-wrap","wrap").style("gap","8px");H.forEach(h=>{const g=v.includes(h.Population),D=c.append("span").style("display","inline-flex").style("align-items","center").style("gap","4px").style("padding","2px 8px").style("background",g?"rgba(0, 0, 0, 0.15)":"rgba(255, 255, 255, 0.8)").style("border-radius","4px").style("cursor","pointer").style("border",g?"2px solid #000":"1px solid #ddd");h.sex==="M"?D.append("span").style("width","8px").style("height","8px").style("border-radius","50%").style("background",K[h.Economy]):D.append("span").style("width","0").style("height","0").style("border-left","4px solid transparent").style("border-right","4px solid transparent").style("border-bottom",`8px solid ${K[h.Economy]}`),D.append("span").style("font-size","11px").style("color","#333").text(h.Population.length>15?h.Population.substring(0,13)+"...":h.Population),D.on("mouseover",function(G){P.html(`
            <strong>${h.Population}</strong><br>
            Sex: ${h.sex==="M"?"Male":"Female"}<br>
            Economy: ${Et[h.Economy]||h.Economy}<br>
            <em>No data for ${C[E.xVar].label} or ${C[E.yVar].label}</em>
          `).style("visibility","visible")}).on("mousemove",function(G){P.style("top",G.pageY-10+"px").style("left",G.pageX+10+"px")}).on("mouseout",function(){P.style("visibility","hidden")})})}}function Bt(e){E={...E,...e}}function Lt(){return{...E}}function it(e){const a=E.highlightedPopulations.indexOf(e);a>-1?E.highlightedPopulations.splice(a,1):E.highlightedPopulations.push(e);const n=new CustomEvent("highlightChanged",{detail:{highlightedPopulations:[...E.highlightedPopulations]}});document.dispatchEvent(n),mt("inactivity-chart")}const Dt=[...new Set(lt.map(e=>e.Population))].sort();let Q=[];function Z(){const e=document.getElementById("unified-y-select"),a=document.getElementById("unified-x-select"),n=document.getElementById("unified-male-cb"),o=document.getElementById("unified-female-cb"),l=document.getElementById("box-view-btn"),t=document.getElementById("scatter-view-btn"),s=[];n&&n.checked&&s.push("M"),o&&o.checked&&s.push("F");const _=Lt(),u=a?a.value:_.xVar,m=e?e.value:_.yVar;let p="auto";u==="Economy_Type"?l&&l.classList.contains("active")?p="box":t&&t.classList.contains("active")&&(p="scatter"):p="scatter",Bt({xVar:u,yVar:m,sexes:s,chartType:p,highlightedPopulations:Q}),mt("inactivity-chart")}const L={"global-patterns":{step:0,totalSteps:6},"combined-question":{step:0,totalSteps:2},bridge:{step:0,totalSteps:1},inactivity:{step:0,totalSteps:5},glp1:{step:0,totalSteps:4}},jt={1:{xVar:"HDI_rank",yVar:"Fat",chartType:"auto"},2:{xVar:"PAL",yVar:"Fat",chartType:"auto"},3:{xVar:"PercUPF",yVar:"Fat",chartType:"auto"},4:{xVar:"PercUPF",yVar:"Fat",chartType:"auto"}},et=["global-patterns-section","combined-question-section","bridge-section","inactivity-section","conclusion-section","glp1-section","glp1-medications-section"];function rt(e){const a=document.getElementById(e);if(!a)return;const n=e.replace("-section",""),o=L[n].step,l=L[n].totalSteps;a.querySelectorAll(".content-card").forEach((u,m)=>{m===o?u.classList.add("active"):u.classList.remove("active")});const s=a.querySelector(".prev-btn"),_=a.querySelector(".next-btn");if(s){const u=et.indexOf(e);s.disabled=o===0&&u===0}_&&(_.disabled=!1,o===l-1&&et.indexOf(e)===et.length-1&&(_.disabled=!0)),_t(n,o)}function _t(e,a){switch(e){case"global-patterns":document.querySelectorAll("#global-patterns-section .piper-guided-graph").forEach((t,s)=>{s===a?t.style.display="block":t.style.display="none"});break;case"inactivity":const o=document.getElementById("inactivity-chart-title"),l=document.getElementById("unified-controls-container");if(document.getElementById("chart-type-control"),a===0){o&&(o.textContent="Data Collection Locations"),l&&(l.style.display="none");const t=document.querySelector(".no-data-section");t&&t.remove(),At("inactivity-chart")}else if(a>=1&&a<=4){const t=jt[a];Bt({xVar:t.xVar,yVar:t.yVar,chartType:t.chartType,sexes:["M","F"],highlightedPopulations:Q});const s={1:"Body Fat % by HDI Rank",2:"Body Fat % vs Physical Activity Level (PAL)",3:"Body Fat % vs Ultra-Processed Food (UPF) %",4:"Interactive Data Explorer"};o&&(o.textContent=s[a]),l&&(l.style.display="flex"),Ot(t),mt("inactivity-chart"),zt()}break}}function Nt(e){const a=et.indexOf(e);if(a<et.length-1){const n=et[a+1],o=document.getElementById(n);o&&o.scrollIntoView({behavior:"smooth",block:"start"})}}function St(e){const a=et.indexOf(e);if(a>0){const n=et[a-1],o=document.getElementById(n);o&&o.scrollIntoView({behavior:"smooth",block:"start"})}}function wt(){document.querySelectorAll(".prev-btn").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.section,n=a.replace("-section","");if(L[n].step>0){L[n].step--,rt(a);const o=document.getElementById(a);o&&o.scrollIntoView({behavior:"auto",block:"start"})}else St(a)})}),document.querySelectorAll(".next-btn").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.section,n=a.replace("-section","");if(L[n].step<L[n].totalSteps-1){L[n].step++,rt(a);const o=document.getElementById(a);o&&o.scrollIntoView({behavior:"auto",block:"start"})}else Nt(a)})}),document.querySelectorAll(".skip-link").forEach(e=>{e.addEventListener("click",a=>{a.preventDefault();const n=parseInt(e.dataset.targetStep),o=e.dataset.section||"inactivity-section";ut(o,n);const l=document.getElementById(o);l&&l.scrollIntoView({behavior:"smooth",block:"start"})})}),Object.keys(L).forEach(e=>{rt(`${e}-section`)})}function Ut(e){L.map.currentYear=e,_t("map",L.map.step)}function $t(e){L.inactivity.viewMode=e;const a=document.getElementById("raw-data-control");a&&(a.style.display=e==="box"?"flex":"none"),Vt(),_t("inactivity",L.inactivity.step)}function Ct(e){L.inactivity.showRawData=e,_t("inactivity",L.inactivity.step)}function Vt(){const e=document.getElementById("inactivity-chart-title");if(!e)return;const a=L.inactivity.metric.toUpperCase();e.textContent=`${a} by Economy Type`}function ut(e,a){const n=e.replace("-section","");L[n].step=a,rt(e)}function Ot(e){const a=document.getElementById("unified-y-select"),n=document.getElementById("unified-x-select"),o=document.getElementById("unified-male-cb"),l=document.getElementById("unified-female-cb"),t=document.getElementById("box-view-btn"),s=document.getElementById("scatter-view-btn"),_=document.getElementById("population-select");document.getElementById("selected-populations"),a&&(a.value=e.yVar),n&&(n.value=e.xVar),o&&(o.checked=!0),l&&(l.checked=!0),_&&(_.value=""),t&&s&&(e.chartType==="box"?(t.classList.add("active"),s.classList.remove("active")):e.chartType==="scatter"?(s.classList.add("active"),t.classList.remove("active")):e.xVar==="Economy_Type"?(t.classList.add("active"),s.classList.remove("active")):(s.classList.add("active"),t.classList.remove("active")))}function zt(){const e=document.getElementById("unified-controls-container"),a=document.getElementById("unified-y-select"),n=document.getElementById("unified-x-select"),o=document.getElementById("unified-male-cb"),l=document.getElementById("unified-female-cb"),t=document.getElementById("box-view-btn"),s=document.getElementById("scatter-view-btn"),_=document.getElementById("population-select"),u=document.getElementById("selected-populations");_&&_.options.length<=1&&Dt.forEach(p=>{const f=document.createElement("option");f.value=p,f.textContent=p,_.appendChild(f)});const m=()=>{u&&(u.innerHTML="",Q.forEach(p=>{const f=document.createElement("span");f.className="population-tag",f.innerHTML=`
        ${p.length>15?p.substring(0,13)+"...":p}
        <span class="population-tag-remove" data-pop="${p}">Ã—</span>
      `,u.appendChild(f)}),u.querySelectorAll(".population-tag-remove").forEach(p=>{p.onclick=f=>{const v=f.target.dataset.pop;Q=Q.filter(I=>I!==v),m(),Z()}}))};if(!e||e.dataset.listenersAttached==="true"){m();return}e.dataset.listenersAttached="true",a&&a.addEventListener("change",Z),n&&n.addEventListener("change",()=>{n.value==="Economy_Type"?(t&&t.classList.add("active"),s&&s.classList.remove("active")):(s&&s.classList.add("active"),t&&t.classList.remove("active")),Z()}),o&&o.addEventListener("change",Z),l&&l.addEventListener("change",Z),t&&t.addEventListener("click",()=>{t.classList.add("active"),s&&s.classList.remove("active"),Z()}),s&&s.addEventListener("click",()=>{s.classList.add("active"),t&&t.classList.remove("active"),Z()}),_&&_.addEventListener("change",()=>{const p=_.value;p&&!Q.includes(p)&&(Q.push(p),m(),Z()),_.value=""}),document.body.dataset.highlightListenerAttached||(document.body.dataset.highlightListenerAttached="true",document.addEventListener("highlightChanged",p=>{Q=p.detail.highlightedPopulations,m()})),m()}function Rt(){const e=document.querySelectorAll(".metric-toggle-btn");e.forEach(u=>{u.addEventListener("click",()=>{e.forEach(p=>p.classList.remove("active")),u.classList.add("active");const m=u.dataset.metric;m==="tee"?ut("inactivity-section",1):m==="pal"&&ut("inactivity-section",2)})});const a=document.querySelectorAll(".view-tab");a.forEach(u=>{u.addEventListener("click",()=>{a.forEach(f=>f.classList.remove("active")),u.classList.add("active");const m=u.dataset.view,p=document.getElementById("raw-data-control");p&&(p.style.display=m==="box"?"flex":"none"),$t(m)})});const n=document.getElementById("show-raw-data-checkbox");n&&n.addEventListener("change",u=>{Ct(u.target.checked)});const o=document.querySelectorAll(".option-button"),l=document.getElementById("belief-next-btn");let t=null;const s=[{key:"exercise",label:"Not getting enough exercise",veryImportant:75,somewhatImportant:20,notImportant:2,dontKnow:1},{key:"diet",label:"Lack of willpower over eating",veryImportant:59,somewhatImportant:31,notImportant:5,dontKnow:2},{key:"food",label:"Kinds of foods marketed at restaurants and groceries",veryImportant:35,somewhatImportant:7,notImportant:5,dontKnow:2},{key:"genetics",label:"Genetics and hereditary factors",veryImportant:32,somewhatImportant:48,notImportant:11,dontKnow:5}];o.forEach(u=>{u.addEventListener("click",()=>{t=u.dataset.option,o.forEach(m=>{m.classList.remove("option-selected")}),u.classList.add("option-selected")})}),l&&l.addEventListener("click",()=>{setTimeout(()=>{const u=document.getElementById("belief-result");u&&(u.className="",u.innerHTML=`
            <div>
              <h4 class="card-title">Percent saying this is a very important reason many Americans are very overweight</h4>
              <div class="bar-chart" id="belief-bar-chart"></div>
            </div>
          `,u.style.display="block",_(t))},300)});function _(u){const m=document.getElementById("belief-bar-chart");if(!m)return;const p=100;s.forEach(f=>{const v=document.createElement("div");v.className="bar-wrapper";const I=document.createElement("div");if(I.className="card-text",I.textContent=f.label,u&&f.key===u){const W=document.createElement("span");W.className="your-guess-tag",W.textContent="Your Guess",I.appendChild(W)}const S=document.createElement("div");S.className="bar-container";const H=document.createElement("div");H.className="bar",f.key==="exercise"&&H.classList.add("bar-highlighted"),H.style.width=`${f.veryImportant/p*100}%`;const V=document.createElement("span");V.className="bar-value",V.textContent=`${f.veryImportant}%`,H.appendChild(V),S.appendChild(H),v.appendChild(I),v.appendChild(S),m.appendChild(v)})}}function Gt(){const e=document.getElementById("piper-block-c");if(!e)return;const a=Array.from(e.querySelectorAll(".content-card")),n=Array.from(e.querySelectorAll(".piper-guided-graph"));function o(t){a.forEach(s=>{Number(s.dataset.step)===t?s.classList.add("active"):s.classList.remove("active")}),n.forEach(s=>{Number(s.dataset.step)===t?s.style.display="block":s.style.display="none"})}o(0),e.querySelectorAll('.nav-btn[data-section="piper-block-c"]').forEach(t=>{t.addEventListener("click",s=>{const _=t.dataset.targetStep;_!==void 0&&(s.preventDefault(),o(Number(_)))})})}document.addEventListener("DOMContentLoaded",()=>{Gt()});const T={selectedCountries:["United States","United Kingdom","Germany","France","Japan"],ageGroup:"adults",yearStart:1975,yearEnd:2022,currentYear:null};function qt(){Yt(),Kt(),Wt(),nt()}function Yt(){const e=document.getElementById("country-filters");if(!e)return;["United States","United Kingdom","Germany","France","Japan","China","Canada","Australia","Mexico","Brazil"].forEach(n=>{const o=document.createElement("label");o.className="country-checkbox-label",n==="United States"&&o.classList.add("usa-label");const l=document.createElement("input");l.type="checkbox",l.value=n,l.checked=T.selectedCountries.includes(n),n==="United States"&&(l.checked=!0,l.disabled=!0),l.addEventListener("change",s=>{if(s.target.checked)if(T.selectedCountries.length<8)T.selectedCountries.push(n);else{s.target.checked=!1;return}else T.selectedCountries=T.selectedCountries.filter(_=>_!==n);nt()});const t=document.createElement("span");t.textContent=n,o.appendChild(l),o.appendChild(t),e.appendChild(o)})}function Kt(){const e=document.querySelectorAll('[data-filter="age"]');e.forEach(a=>{a.addEventListener("click",()=>{e.forEach(n=>n.classList.remove("active")),a.classList.add("active"),T.ageGroup=a.dataset.value,nt()})})}function Wt(){const e=document.getElementById("year-start"),a=document.getElementById("year-end"),n=document.getElementById("year-start-label"),o=document.getElementById("year-end-label");!e||!a||(e.addEventListener("input",l=>{const t=parseInt(l.target.value);T.yearStart=t,n.textContent=t,t>T.yearEnd&&(T.yearEnd=t,a.value=t,o.textContent=t),nt()}),a.addEventListener("input",l=>{const t=parseInt(l.target.value);T.yearEnd=t,o.textContent=t,t<T.yearStart&&(T.yearStart=t,e.value=t,n.textContent=t),nt()}))}function nt(){kt("multi-country-trend",T.selectedCountries,T.ageGroup,T.yearStart,T.yearEnd,T.currentYear)}function pt(e){T.currentYear=e,nt()}const at=Object.keys(gt).map(Number).sort((e,a)=>e-a);let yt=!1,tt=at.length-1,ct=null;function Xt(){const e=document.getElementById("play-btn");document.getElementById("current-year");const a=document.getElementById("play-icon"),n=document.getElementById("pause-icon"),o=document.getElementById("play-text");e&&(e.addEventListener("click",()=>{yt?(It(),pt(null),a.style.display="block",n.style.display="none",o.textContent="Play Timeline"):(Jt(),a.style.display="none",n.style.display="block",o.textContent="Pause")}),xt())}function Jt(){yt=!0,tt=0,ct=setInterval(()=>{if(tt<at.length){const e=at[tt];Ut(e),pt(e),xt(),tt++}else{It(),tt=at.length-1,pt(null);const e=document.getElementById("play-icon"),a=document.getElementById("pause-icon"),n=document.getElementById("play-text");e.style.display="block",a.style.display="none",n.textContent="Play Timeline"}},800)}function It(){yt=!1,ct&&(clearInterval(ct),ct=null)}function xt(){const e=document.getElementById("current-year");e&&tt>=0&&tt<at.length&&(e.textContent=at[tt])}function ht(){wt(),Rt(),Xt(),qt(),Zt()}function Zt(){const e=document.getElementById("explore-now-btn");e&&e.addEventListener("click",()=>{const a=document.getElementById("global-patterns-section");a&&a.scrollIntoView({behavior:"smooth",block:"start"})})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ht):ht();
